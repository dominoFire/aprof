#!/bin/bash



cd dsp

if [ ! -z $1 ]; then

make clean 2>/dev/null >/dev/null
make  2>/dev/null >/dev/null

/usr/bin/time -p -o res bin/dsp < scripts/aprof_benchmark1.txt 2>/dev/null
echo -n "DSP(native): " && cat res | grep real

/usr/bin/time -p -o res valgrind bin/dsp < scripts/aprof_benchmark1.txt 2>/dev/null
echo -n "DSP(valgrind): " && cat res | grep real

/usr/bin/time -p -o res valgrind --tool=callgrind bin/dsp < scripts/aprof_benchmark1.txt 2>/dev/null
echo -n "DSP(callgrind): " && cat res | grep real

/usr/bin/time -p -o res valgrind --tool=memcheck bin/dsp < scripts/aprof_benchmark1.txt 2>/dev/null
echo -n "DSP(memcheck): " && cat res | grep real

fi

cd ../../valgrind
make  2>/dev/null >/dev/null
make install 2>/dev/null >/dev/null
cd ../benchmark/dsp
make clean 2>/dev/null >/dev/null
make valgrind 2>/dev/null >/dev/null
/usr/bin/time -p -o res ../../valgrind/inst/bin/valgrind --tool=aprof bin/dsp < scripts/aprof_benchmark1.txt 2>/dev/null
echo -n "DSP(aprof): " && cat res | grep real

rm res

exit 0
